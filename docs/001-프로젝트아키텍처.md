# 001-프로젝트아키텍처.md

## 프로젝트 개요

**TeamSync Pro**는 VS Code 확장과 웹 콘솔을 통해 팀 단위 에디터 설정 동기화 및 협업을 지원하는 통합 솔루션입니다.

### 핵심 가치 제안
- **설정 표준화**: 팀 내 일관된 개발 환경 구축
- **원클릭 동기화**: 복잡한 설정 과정 자동화
- **협업 강화**: 프롬프트, 스니펫 공유를 통한 지식 전파
- **거버넌스**: 권한 관리 및 변경 이력 추적

## 시스템 아키텍처

### 전체 구조도
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   VS Code       │    │   Web Console   │    │   AWS Cloud     │
│   Extension     │◄──►│   (React SPA)   │◄──►│   Backend       │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │                       │                       │
    ┌────▼────┐             ┌────▼────┐             ┌────▼────┐
    │ Local   │             │ Browser │             │ AWS     │
    │ Config  │             │ Storage │             │ Services│
    └─────────┘             └─────────┘             └─────────┘
```

### 컴포넌트 상세

#### 1. VS Code Extension (클라이언트)
- **인증 모듈**: OAuth 2.0 기반 사용자 인증
- **동기화 엔진**: 로컬 ↔ 원격 설정 동기화
- **충돌 해결**: 설정 변경 충돌 감지 및 해결
- **UI 컴포넌트**: Command Palette, 상태 표시, 설정 패널

#### 2. Web Console (프론트엔드)
- **대시보드**: 팀 현황, 활동 로그, 통계
- **그룹 관리**: 팀 생성, 멤버 초대, 권한 설정
- **설정 뷰어**: 설정 파일 미리보기, 비교, 편집
- **히스토리**: 변경 이력, 롤백, 감사 로그

#### 3. Backend API (AWS 기반)
- **인증 서비스**: JWT 토큰 관리, OAuth 연동
- **설정 관리**: CRUD, 버전 관리, 충돌 해결
- **그룹 서비스**: 팀 관리, 권한 제어, 초대 시스템
- **알림 서비스**: 실시간 알림, 이메일 발송

## 기술 스택

### Frontend
- **VS Code Extension**: TypeScript, VS Code API
- **Web Console**: React 18, TypeScript, Tailwind CSS
- **상태 관리**: Zustand, React Query
- **빌드 도구**: Vite, ESBuild

### Backend
- **Runtime**: Node.js 18+, Express.js
- **Database**: Amazon RDS (PostgreSQL), Redis
- **Authentication**: AWS Cognito, JWT
- **Storage**: Amazon S3, CloudFront CDN

### Infrastructure
- **Compute**: AWS Lambda, ECS Fargate
- **API Gateway**: AWS API Gateway v2
- **Monitoring**: CloudWatch, X-Ray
- **CI/CD**: GitHub Actions, AWS CodePipeline

## 데이터 모델

### 핵심 엔티티

#### User (사용자)
```typescript
interface User {
  id: string;
  email: string;
  name: string;
  avatar?: string;
  provider: 'google' | 'github' | 'email';
  createdAt: Date;
  lastLoginAt: Date;
}
```

#### Team (팀)
```typescript
interface Team {
  id: string;
  name: string;
  description?: string;
  ownerId: string;
  settings: TeamSettings;
  createdAt: Date;
  updatedAt: Date;
}

interface TeamSettings {
  visibility: 'public' | 'private';
  allowMemberInvite: boolean;
  requireApproval: boolean;
}
```

#### Configuration (설정)
```typescript
interface Configuration {
  id: string;
  teamId: string;
  name: string;
  description?: string;
  editorType: 'vscode' | 'cursor';
  settings: ConfigurationData;
  version: number;
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
}

interface ConfigurationData {
  settings?: Record<string, any>;
  keybindings?: KeyBinding[];
  extensions?: Extension[];
  snippets?: Snippet[];
}
```

#### Prompt (프롬프트)
```typescript
interface Prompt {
  id: string;
  teamId: string;
  name: string;
  description?: string;
  content: string;
  category: string;
  tags: string[];
  isPublic: boolean;
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
}
```

## API 설계

### RESTful API 구조
```
/api/v1
├── /auth
│   ├── POST /login
│   ├── POST /logout
│   ├── POST /refresh
│   └── GET /me
├── /teams
│   ├── GET /
│   ├── POST /
│   ├── GET /:id
│   ├── PUT /:id
│   ├── DELETE /:id
│   ├── POST /:id/members
│   └── DELETE /:id/members/:userId
├── /configurations
│   ├── GET /teams/:teamId/configurations
│   ├── POST /teams/:teamId/configurations
│   ├── GET /:id
│   ├── PUT /:id
│   ├── DELETE /:id
│   └── GET /:id/history
└── /prompts
    ├── GET /teams/:teamId/prompts
    ├── POST /teams/:teamId/prompts
    ├── GET /:id
    ├── PUT /:id
    └── DELETE /:id
```

### WebSocket Events
```typescript
// 실시간 동기화 이벤트
interface SyncEvents {
  'config:updated': { configId: string; version: number };
  'team:member-joined': { teamId: string; user: User };
  'team:member-left': { teamId: string; userId: string };
  'prompt:created': { teamId: string; prompt: Prompt };
}
```

## 보안 설계

### 인증 & 인가
- **OAuth 2.0**: Google, GitHub 소셜 로그인
- **JWT 토큰**: Access Token (15분), Refresh Token (7일)
- **RBAC**: Owner, Admin, Member 역할 기반 권한 제어

### 데이터 보호
- **암호화**: 민감 데이터 AES-256 암호화
- **HTTPS**: 모든 통신 TLS 1.3 강제
- **입력 검증**: 모든 API 입력값 스키마 검증
- **Rate Limiting**: API 호출 제한 (100req/min/user)

### 감사 로그
```typescript
interface AuditLog {
  id: string;
  userId: string;
  teamId?: string;
  action: string;
  resource: string;
  resourceId: string;
  metadata: Record<string, any>;
  ipAddress: string;
  userAgent: string;
  timestamp: Date;
}
```

## 성능 최적화

### 캐싱 전략
- **Redis**: 세션, 설정 캐시 (TTL: 1시간)
- **CDN**: 정적 자산, API 응답 캐시
- **브라우저**: 설정 데이터 로컬 캐시

### 동기화 최적화
- **Delta Sync**: 변경된 부분만 동기화
- **압축**: gzip 압축으로 전송량 최소화
- **배치 처리**: 여러 설정 변경 일괄 처리

### 모니터링
- **메트릭**: 응답 시간, 에러율, 처리량
- **알람**: 임계값 초과 시 Slack 알림
- **대시보드**: Grafana 실시간 모니터링

## 확장성 고려사항

### 수평 확장
- **Stateless API**: 서버 상태 비저장으로 스케일링 용이
- **Load Balancer**: ALB를 통한 트래픽 분산
- **Database Sharding**: 팀 단위 데이터 분산

### 국제화 지원
- **다국어**: i18n 라이브러리 활용 (한국어, 영어)
- **시간대**: UTC 기준 저장, 클라이언트에서 로컬 변환
- **통화**: 향후 유료 플랜 지원 시 다중 통화 고려

## 배포 전략

### 환경 구성
- **Development**: 로컬 개발 환경
- **Staging**: 프로덕션 동일 환경 테스트
- **Production**: 실제 서비스 환경

### CI/CD 파이프라인
```yaml
# GitHub Actions Workflow
name: Deploy
on:
  push:
    branches: [main]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Run tests
        run: npm test
  
  deploy:
    needs: test
    runs-on: ubuntu-latest
    steps:
      - name: Deploy to AWS
        run: aws deploy create-deployment
```

### 롤백 전략
- **Blue-Green 배포**: 무중단 배포 및 즉시 롤백
- **Database Migration**: 순방향/역방향 마이그레이션 스크립트
- **Feature Flag**: 기능별 on/off 제어

## 다음 단계

1. **001-프로젝트아키텍처.md** ✅
2. **002-VS코드확장개발.md** (다음)
3. **003-웹콘솔개발.md**
4. **004-백엔드API개발.md**
5. **005-데이터베이스설계.md**
6. **006-인증보안구현.md**
7. **007-배포인프라구축.md**
8. **008-테스트전략.md**
9. **009-성능최적화.md**
10. **010-운영모니터링.md**
